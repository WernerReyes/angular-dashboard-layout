<p-splitter
    [layout]="isMobile() ? 'vertical' : 'horizontal'"
    [panelSizes]="isMobile() ? [40, 60] : [25, 75]"
    [style]="{ height: '300px' }"
    panelStyleClass="bg-gradient-to-br from-gray-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 transition-all duration-300"
>
    <ng-template #panel>
        <!-- <div class="flex items-center justify-center h-full">Panel 1</div> -->
        <app-error-boundary [resource]="categoryList" errorMessage="Ocurrió un error cargando las categorias recientes." emptyMessage="No hay categorias recientes">
            <ng-template #content let-categories>
                @let categoriesFiltered = categories | filterByIds : categoriesIds() : 'id'; @if (categoriesFiltered.length > 0) {

                <div class="p-3">
                    <p-listbox [scrollHeight]="isMobile() ? '100px' : ''" [options]="categoriesFiltered" [(ngModel)]="selectedCategoryId" optionLabel="title" optionValue="id" class="w-full" />
                </div>
                } @else {
                <div class="flex flex-col items-center text-center justify-center my-auto h-full py-8 text-surface-500">
                    <i class="pi pi-inbox text-4xl mb-3"></i>
                    <div class="font-semibold text-lg mb-1">No se encontraron categorias</div>
                    <div class="text-sm">No hay categorias asociadas a los items de esta sección.</div>
                </div>
                }
            </ng-template>
        </app-error-boundary>
    </ng-template>
    <ng-template #panel>
        @let itemsByCategory = section().items | filterByIds : selectedCategoryId() : 'categoryId';
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 p-3 h-full overflow-y-auto">
            @if (itemsByCategory.length === 0) {
            <div class="flex flex-col items-center justify-center py-8 text-surface-500 col-span-full">
                <i class="pi pi-inbox text-4xl mb-3"></i>
                <div class="font-semibold text-lg mb-1">No se encontraron items</div>
                <div class="text-sm">Intenta seleccionar otra categoría o agrega nuevos items a esta sección.</div>
            </div>
            } @else { @for (item of itemsByCategory; track item.id) {
            <p-card class="h-full" (contextmenu)="contextMenu()?.onContextMenu($event, item)">
                <ng-template #header>
                    @if (item.image) {
                    <img alt="Card" class="w-full h-48 object-cover" (error)="item.image = null" [src]="item.image" />

                    }@else {
                    <app-image-error></app-image-error>
                    }
                </ng-template>
                <ng-template #title>
                    <div class="flex items-center gap-4">{{ item.title }}</div>
                </ng-template>
                <p>{{ item.description }}</p>

                @if (item.textButton) {

                <ng-template #footer>
                    <div class="flex gap-4 mt-1">
                        <p-button [label]="item.textButton" class="w-full" styleClass="w-full" />
                    </div>
                </ng-template>
                }
            </p-card>
            } }
        </div>
    </ng-template>
</p-splitter>
