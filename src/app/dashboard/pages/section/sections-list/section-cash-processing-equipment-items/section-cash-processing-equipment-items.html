<!-- section-cash-processing-equipment-items.html -->
<section class="bg-gradient-to-br from-gray-50 to-slate-100 dark:from-slate-900 dark:to-slate-800 py-20 transition-all duration-300">
    <div class="container mx-auto px-4">
        <!-- Texto principal -->
        <div class="text-center mb-16">
            @if (section().title) {

            <h2 class="!text-xl md:!text-2xl !font-bold text-primary-600 dark:text-primary-400 mb-4">{{ section().title }}</h2>
            } @else {
            <empty-field-message className="max-w-md mx-auto mb-4" textContent="Sin título"></empty-field-message>
            }

            <!-- @if (section().textButton) {
            <div class="mt-8">
                <p-button label="{{ section().textButton }}"></p-button>
            </div>
            } @else {
            <empty-field-message className="mx-auto mt-4 max-w-lg" textContent="Sin texto de botón"></empty-field-message>
            } -->
        </div>

        @if (section().machines?.length === 0) {
        <empty-field-message className="max-w-lg mx-auto" textContent="No hay equipos disponibles"></empty-field-message>
        } @else {
        <div class="flex justify-end mb-3">
            <p-toggleswitch #tsSwitch>
                <ng-template #handle let-checked="checked">
                    @let option = checked ? getOption(CategoryType.COIN) : getOption(CategoryType.BILL);
                    <!-- {{ option?.icon }} -->
                    <i [ngClass]="['!text-xs', option?.icon]" [style]="{ color: option?.color }"></i>
                </ng-template>
            </p-toggleswitch>
        </div>

        @let filteredMachines = filterByCategoryType(tsSwitch.checked()); @if (filteredMachines.length === 0) {
        <empty-field-message className="max-w-lg mx-auto" textContent="No hay equipos disponibles para esta categoría"></empty-field-message>
        } @else {

        <p-carousel
            [ngClass]="{
            'max-w-72 sm:max-w-sm mx-auto': isPreview()
        }"
            [value]="filteredMachines"
            [numVisible]="isPreview() ? 1 : 3"
            [numScroll]="1"
            [circular]="true"
            [autoplayInterval]="5000"
            [responsiveOptions]="responsiveOptions()"
        >
            <ng-template #item let-machine>
                <p-card class="mx-2">
                    <ng-template #header>
                        <div class="flex justify-center pt-6">
                            <img [src]="getMainImageUrl(machine)" [alt]="machine.name" class="size-40 object-contain rounded-lg bg-white p-2 shadow-sm" />
                        </div>
                    </ng-template>

                    <div class="p-6 flex flex-col items-center text-center">
                        <h6 class="text-lg font-semibold text-surface-900 dark:text-surface-100">{{ machine.name }}</h6>
                        <p class="mt-3 text-sm text-slate-600 dark:text-slate-300">{{ machine.description }}</p>

                        @if (machine.linkId && machine.textButton) {
                        <p-button [label]="machine.textButton"> </p-button>
                        }
                    </div>

                    <ng-template #footer>
                        <div class="flex flex-wrap gap-2 w-fit items-center">
                            @let option = getOption(machine.category.type);
                            <!-- <p-tag class="mx-auto" [value]="machine.category?.title" severity="info"></p-tag> -->
                            <span class="bg-surface-300 dark:bg-surface-800 p-2 rounded-xs text-sm"> {{ machine.category?.title }} </span>
                            <i class="bg-surface-300 dark:bg-surface-800 p-2 rounded-xs" [class]="option?.icon"></i>
                        </div>
                    </ng-template>
                </p-card>
            </ng-template>
        </p-carousel>

        } }
    </div>
</section>
